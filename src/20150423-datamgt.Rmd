---
layout: lesson
root: ..
---

```{r, include = FALSE}
source("chunk_options.R")
```

# Gestion de données dans R (II) - Opérations sur les variables et observations

## Transformation de variables

Contrairement à d'autres logiciels statistiques, `R` peut transformer des
données et les analyser en même temps.

```{r import-health}
library(gapminder)
str(gapminder)
head(gapminder)
summary(gapminder$pop / 10^6)
```

Les différentes opérations disponibles dans `R` sont données dans le tableau
suivant.

| Addition | `x + y` |
| Soustraction | `x - y` |
| Multiplication | `x * y` |
| Division | `x / y`|
| Opérateur puissance | `x^2` |
| Racine carrée | `sqrt(x)` |
| Exponentielle en base 10 | `10^x` |
| Exponentielle en base `e` | `exp(x)` |
| Logarithme en base 10 | `log10(x)` |
| Logarithme naturel | `log(x)` |
| Arrondi | `round(x)` |

On peut créer une nouvelle colonne reprenant la population exprimée en million:

```{r}
gapminder$pop6 <- with(gapminder, pop / 10^6)
gapminder <- transform(gapminder, pop6 = pop / 10^6)
library(dplyr)
gapminder <- mutate(gapminder,
                    pop6 = pop / 10^6,
                    pop3 = pop6 * 1000)
population <- transmute(gapminder, pop6 = pop / 10^6)
```

## Renommer les variables

Les noms des colonnes (variables) (et aussi des observations --- lignes) sont
des attributs du `data frame`. Ils peuvent donc être manipulés facilement.

```{r attr}
str(attributes(gapminder))
names(gapminder)
```

On peut remplacer un nom par un autre soit en utilisant le nom de la colonne
soit en utilisant son index.

```{r rename-base}
names(gapminder[names(gapminder) == "pop3"]) <- "newPop3"
names(gapminder[8]) <- "verynewPop3"
```

On peut aussi utiliser la fonction `rename` des *packages* `dplyr`, `reshape` ou
`plyr`.

```{r rename-hadley}
gapminder <- dplyr::rename(gapminder, pop3 = verynewPop3)
# install.packages("reshape")
library(reshape)
gapminder <- rename(gapminder, c(pop6 = "npop6", pop3 = "npop3"))
library(plyr)
gapminder <- rename(gapminder, replace = c("npop6" = "pop6", "npop3" = "pop3"))
```

